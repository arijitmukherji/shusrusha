        if st.session_state.processing_started and st.session_state.processing_in_progress:
            # Reset processing state for new run
            st.session_state.processing_logs = []
            st.session_state.processing_completed = False
            st.session_state.processing_results = {}
            st.session_state.processing_in_progress = False
            st.session_state.processing_started = False
            
            # Process documents directly
            process_documents(uploaded_files, ocr_model, extraction_model, pharmacy_model, 
                            save_files, open_files, show_debug, 
                            run_diagnoses, run_medications, run_pharmacy, run_summary)
